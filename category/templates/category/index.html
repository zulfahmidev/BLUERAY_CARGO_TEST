{% extends "layouts/base.html" %}

{% block title %}Category list{% endblock %}

{% block content %}
    <div class="flex justify-between items-center mb-6">
        <a href="{% url 'country.index' %}" class="text-blue-500 hover:underline">Back to Country List</a>
        <div class="">
            <form class="inline-block">
                <input type="text" placeholder="Search categories..." class="py-2 px-3 border border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500" name="search" value="{{ request.GET.search|default_if_none:'' }}" onkeyup.enter="this.form.submit()">
            </form>
            <a href="{% url 'category.create' country.id %}" class="bg-blue-500 text-white px-3 py-3 rounded hover:bg-blue-600">Add Category</a>
        </div>
    </div>
    <table class="min-w-full bg-white">
        <thead>
            <tr class="w-full bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                <th class="py-3 px-6 text-left">#</th>
                <th class="py-3 px-6 text-left">Title</th>
                <th class="py-3 px-6 text-left">Price</th>
                <th class="py-3 px-6 text-left">Action</th>
            </tr>
        </thead>
        <tbody class="text-gray-600 text-sm font-light">
            {% for category in categories %}
            <tr class="border-b border-gray-200 even:bg-gray-100">
                <td class="py-3 px-6 text-left">
                    {{ forloop.counter }}
                </td>
                <td class="py-3 px-6 text-left">{{ category.category_title }}</td>
                <td class="py-3 px-6 text-left">{{ category.price_per_kilo }}</td>
                <td class="py-3 px-6 text-left">
                    <a href="{% url 'category.edit' country.id category.id %}" class="inline-block bg-blue-500 text-white py-1 px-2 rounded">Edit</a>
                    <form action="{% url 'category.delete' country.id category.id %}" method="post" class="inline-block">
                        {% csrf_token %}
                        <input type="hidden" name="category_id" value="{{ category.id }}">
                        <button type="submit" class="bg-red-500 text-white py-1 px-2 rounded cursor-pointer" onclick="return confirm('Are you sure you want to delete?')">Delete</button>
                    </form>
                </td>
            </tr>
            {% empty %}
            <tr class="border-b border-gray-200 even:bg-gray-100">
                <td colspan="5" class="py-3 px-6 text-center">No categories available</td>
            </tr>
            {% endfor %}
            <!-- Add more rows as needed -->
        </tbody>
    </table>

    <div class="mt-6 flex items-center gap-3 mx-auto mr-0 w-fit">
        {% if categories.has_previous %}
            <a class="py-2 px-3 bg-blue-500 text-white rounded" href="?page=1">First</a>
            <a class="py-2 px-3 bg-blue-500 text-white rounded" href="?page={{ categories.previous_page_number }}">Previous</a>
        {% endif %}

        <span>Page {{ categories.number }} of {{ categories.paginator.num_pages }}</span>

        {% if categories.has_next %}
            <a class="py-2 px-3 bg-blue-500 text-white rounded" href="?page={{ categories.next_page_number }}">Next</a>
            <a class="py-2 px-3 bg-blue-500 text-white rounded" href="?page={{ categories.paginator.num_pages }}">Last</a>
        {% endif %}
    </div>
{% endblock %}